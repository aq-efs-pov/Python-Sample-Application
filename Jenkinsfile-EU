        stage('Code Repository Scanned by Aqua') {
            withCredentials([
                string(credentialsId: 'AQUA_KEY', variable: 'AQUA_KEY'), 
                string(credentialsId: 'AQUA_SECRET', variable: 'AQUA_SECRET'),
                string(credentialsId: 'GITHUB_TOKEN', variable: 'GITHUB_TOKEN')
            ]) {
                sh '''
                    export AQUA_URL=https://eu-1.supply-chain.cloud.aquasec.com  
                    export CSPM_URL=https://eu-1.api.cloudsploit.com
                    // your usual code below
                '''
            }
        }
        stage('Manifest Generation') {
            withCredentials([
                string(credentialsId: 'GITHUB_TOKEN', variable: 'GITHUB_TOKEN'), 
                string(credentialsId: 'AQUA_KEY', variable: 'AQUA_KEY'), 
                string(credentialsId: 'AQUA_SECRET', variable: 'AQUA_SECRET')
            ]) {
                sh '''
                    export BILLY_SERVER=https://billy.eu-1.codesec.aquasec.com
                    export AQUA_URL=https://eu-1.supply-chain.cloud.aquasec.com  
                    export CSPM_URL=https://eu-1.api.cloudsploit.com
                    // your usual code below
                '''
            }
        }
    }
}